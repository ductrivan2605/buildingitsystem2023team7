<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="../../public/css/header.css">
  <link rel="icon" type="image/x-icon" href="../../public/images/logo.png">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="../../public/js/nav.js" defer></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <title>Wishlist</title>
</head>
<body>
    <header class="header">
        <div class="logo">
            <a href="#"><img src="../../public/images/logo.png" alt=""></a>
        </div>
        <button class="menu-button" onclick="toggleMenu()"><i class="fa-solid fa-bars"></i></button>
        <nav class="navBar">
            <ul class="NavList" id="navList">
                <li class="NavList-item"><a href="#">Home</a></li>
                <li class="NavList-item"><a href="#">Trending</a></li>
                <li class="NavList-item"><a href="#">New Arrival</a></li>
               
               <li class="NavList-item">
                    <a href="#">Categories <i class="fa-solid fa-caret-down"></i></a>
                    <div class="dropDown">
                        <ul class="dropDownList">
                            <li class="dropDownItem"><a href="#">Lv1 <i class="fa-solid fa-arrow-right"></i></a>
                                <ul class="dropDownList-lv2">
                                    <li class="dropDownItem-lv2"><a href="#">Lv2</a></li>
                                    <li class="dropDownItem-lv2"><a href="#">Lv2</a></li>
                                </ul>
                            </li>
                            <li class="dropDownItem"><a href="#">Lv1 <i class="fa-solid fa-arrow-right"></i></a>
                                <ul class="dropDownList-lv2">
                                    <li class="dropDownItem-lv2"><a href="#">Lv2</a></li>
                                    <li class="dropDownItem-lv2"><a href="#">Lv2</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </li>  
            </ul>
            
        </nav>

        <form class="search">
            <input type="text" placeholder="What are you finding?">
            <button type="submit">Search</button>
        </form>
        <div class="user" id="userSection">
            <div class="user-info" onclick="toggleUserMenu()">
                <img id="userAvatar" src="" alt="User Avatar">
                <span id="userName">User Name</span>
                <i class="fa-solid fa-caret-down"></i>
            </div>
            <div class="user-dropdown" id="userDropdown">
                <!-- Dropdown menu content -->
                <a href="#">Profile</a>
                <a href="#">Settings</a>
                <a href="#">Logout</a>
            </div>
        </div>
    </header>
    <main class="main">
        
        <h1>Wishlist Admin Dashboard</h1>

        <!-- Display all submitted wishlist items -->
        <div class="wishlist-h1" id="wishlistItems">
          <!-- Each wishlist item will be displayed here -->
        </div>
      
        <script>
          // Function to fetch and display wishlist items
          async function fetchWishlistItems() {
            try {
              const response = await fetch('/wishlist/all'); // Assuming you have a route to fetch all wishlist items
              const wishlistItems = await response.json();
      
              const wishlistItemsContainer = document.getElementById('wishlistItems');
              wishlistItemsContainer.innerHTML = ''; // Clear previous items
      
              wishlistItems.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.innerHTML = `
                  <p>Author: ${item.authorWishlist}</p>
                  <p>Title: ${item.titleWishlist}</p>
                  <p>Date: ${item.dateWishlist}</p>
                  <p>Image: <img src="${item.imageWishlist}" alt="Wishlist Item Image" style="max-width: 200px;"></p>
                  <p>Approved: ${item.approved ? 'Yes' : 'No'}</p>
                  <button onclick="approveItem('${item._id}')">Approve</button>
                  <button onclick="deleteItem('${item._id}')">Delete</button>
                  <hr>
                `;
                wishlistItemsContainer.appendChild(itemDiv);
              });
            } catch (error) {
              console.error('Error fetching wishlist items:', error);
            }
          }
      
          // Function to approve a wishlist item
          async function approveItem(itemId) {
            try {
              await fetch(`/wishlist/approveWishlist/${itemId}`, { method: 'POST' });
              fetchWishlistItems(); // Refresh the list after approval
            } catch (error) {
              console.error('Error approving wishlist item:', error);
            }
          }
      
          // Function to delete a wishlist item
          async function deleteItem(itemId) {
            try {
              await fetch(`/wishlist/deleteWishlist/${itemId}`, { method: 'POST' });
              fetchWishlistItems(); // Refresh the list after deletion
            } catch (error) {
              console.error('Error deleting wishlist item:', error);
            }
          }
      
          // Fetch and display wishlist items when the page loads
          fetchWishlistItems();
        </script>
       
           
    </main>
 
  </body>
  </html>